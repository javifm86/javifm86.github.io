<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.58.3" />

<link rel="stylesheet" href="https://javifm.com/beta/css/styles.css">


<title>Ellipsis de múltiples líneas con Javascript | Frontend developer</title>

    
</head>

<body>
    <div id="site-wrapper" class="relative overflow-hidden w-full">
        <div id="site-canvas" class="w-full h-full relative">
            



<a id="skiplink" class="sr-only absolute top-0 left-0 mt-2 ml-1 font-semibold bg-gray-300 rounded-sm p-2 uppercase text-gray-700" href="#main">
    Saltar al contenido principal
</a>

<div class="bg-gray-100 prefers-dark:bg-gray-900 border-t-4 border-green-500">
    <div class="container mx-auto">
        <nav class="flex flex-wrap justify-end items-center py-6 px-4">
            
                
                
                
                
                
                    
                
                <a class="mr-6 first:-ml-2 p-2 uppercase text-gray-700 hidden sm:inline-flex hover:bg-gray-300 hover:rounded-sm" href="/beta/">Inicio</a>
            
                
                
                
                
                
                    
                
                <a class="mr-6 first:-ml-2 p-2 uppercase text-gray-700 hidden sm:inline-flex font-semibold bg-gray-300 rounded-sm" href="/beta/blog/">Blog</a>
            
                
                
                
                
                
                    
                
                <a class="mr-6 first:-ml-2 p-2 uppercase text-gray-700 hidden sm:inline-flex hover:bg-gray-300 hover:rounded-sm" href="/beta/tags/">Tags</a>
            
                
                
                
                
                
                    
                
                <a class="mr-6 first:-ml-2 p-2 uppercase text-gray-700 hidden sm:inline-flex hover:bg-gray-300 hover:rounded-sm" href="/beta/sobre-mi/">Sobre mí</a>
            
                
                
                
                
                
                    
                
                <a class="mr-6 first:-ml-2 p-2 uppercase text-gray-700 hidden sm:inline-flex hover:bg-gray-300 hover:rounded-sm" href="/beta/search/">Buscar</a>
            
            <button type="button" id="sidebar-open" aria-label="Abrir menu" class="sm:hidden text-gray-700 flex items-center uppercase text-xl p-1 -m-1">
                Menú
                



















<svg xmlns="http://www.w3.org/2000/svg" class='ml-2 w-6 h-6 fill-current'  id='open-menu' role="img" aria-labelledby="titleId" viewBox="0 0 20 20"><title id="titleId">Menú</title><path role="presentation" d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg>


                



















<svg xmlns="http://www.w3.org/2000/svg" class='ml-2 w-6 h-6 fill-current hidden'  id='close-menu' role="img" aria-labelledby="titleId" viewBox="0 0 20 20"><title id="titleId">Cerrar</title><path role="presentation" d="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z"></path></svg>


            </button>
        </nav>
    </div>
</div>

<div id="site-menu" class="h-full absolute top-0 py-6 px-4 bg-gray-800 hidden">
    <nav class="flex flex-col uppercase text-xl">
    
        
        
        
        
        
            
        
        <a class="mb-1 px-4 py-2 text-gray-100" href="/beta/">Inicio</a>
    
        
        
        
        
        
            
        
        <a class="mb-1 px-4 py-2 bg-green-600 rounded text-white font-semibold outline-none focus:bg-white focus:text-green-600" href="/beta/blog/">Blog</a>
    
        
        
        
        
        
            
        
        <a class="mb-1 px-4 py-2 text-gray-100" href="/beta/tags/">Tags</a>
    
        
        
        
        
        
            
        
        <a class="mb-1 px-4 py-2 text-gray-100" href="/beta/sobre-mi/">Sobre mí</a>
    
        
        
        
        
        
            
        
        <a class="mb-1 px-4 py-2 text-gray-100" href="/beta/search/">Buscar</a>
    
    </nav>
</div>

            <main id="main">
                

<div class="container mx-auto px-4 single-post">
    <div class="my-6">
        <h1 class="title">Ellipsis de múltiples líneas con Javascript</h1>
        

<div class="flex flex-wrap flex-col sm:flex-row sm:items-center text-gray-700">
    <time datetime="2015-09-07">
        Publicado el 7 Sep 2015</time>
    
    <span>
        <span class="mx-2 hidden sm:inline-flex">&bull;</span>Tiempo de lectura: 2min
    </span>
    
</div>

    <div class="mt-4">
        
            
            <a class="tag inline-block text-sm mr-2 mb-2" href="https://javifm.com/beta/tags/javascript">javascript</a>
        
            
            <a class="tag inline-block text-sm mr-2 mb-2" href="https://javifm.com/beta/tags/css">css</a>
        
    </div>


    </div>
    <div class="single-post-content">
        <p>Ellipsis es simplemente un cáracter compuesto por tres puntos: &#8220;…&#8221;. En desarrollo web, se aplica a textos muy largos que son más grandes que su contenedor, y por tanto queremos que sean recortados agregando al final el carácter ellipsis. Con el avance de los estándares css modernos, ya podemos aplicar una solución sin necesidad de echar mano de Javascript:</p>

<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="p">.</span><span class="nc">ellipsis</span> <span class="p">{</span>
    <span class="k">white-space</span><span class="p">:</span> <span class="kc">nowrap</span><span class="p">;</span>
    <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
    <span class="k">text-overflow</span><span class="p">:</span> <span class="kc">ellipsis</span><span class="p">;</span>
    <span class="kp">-o-</span><span class="k">text-overflow</span><span class="p">:</span> <span class="kc">ellipsis</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>¿Cual es la limitación? Que sólo funciona en textos con una línea, si tenemos más de una línea no funciona, y es ahí donde entra en juego Javascript. He creado una sencilla función, simplemente es necesario que en css el elemento disponga de un line-height definido para funcionar.</p>

<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="cm">/**
</span><span class="cm"> *  Acorta strings multilinea añadiendo el símbolo ellipsis.
</span><span class="cm"> *  @param  {jQuery}  $obj     : Objeto jQuery a aplicar si es necesario.
</span><span class="cm"> *                               Importante, debe tener line-height definido.
</span><span class="cm"> *  @param  {String}  val      : Texto a insertar.
</span><span class="cm"> *  @param  {Number}  maxLines : Máximo de líneas permitidas.
</span><span class="cm"> */</span>

<span class="kd">function</span> <span class="nx">ellipsis</span><span class="p">(</span> <span class="nx">$obj</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">maxLines</span> <span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">maxLines</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">$obj</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="nx">val</span> <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">_valueAux</span> <span class="o">=</span> <span class="nx">val</span><span class="p">,</span>
        <span class="nx">_lenValueAux</span> <span class="o">=</span> <span class="nx">_valueAux</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
        <span class="nx">_heightLine</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$obj</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&#34;line-height&#34;</span> <span class="p">)</span> <span class="p">),</span>

        <span class="cm">/*
</span><span class="cm">         *  Añadimos 2 porque algunos navegadores redondean line-height,
</span><span class="cm">         *  asi que cubrimos el máximo valor en px de line-height redondeado.
</span><span class="cm">         */</span>
        <span class="nx">_maxHeight</span> <span class="o">=</span> <span class="nx">maxLines</span> <span class="o">*</span> <span class="nx">_heightLine</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

    <span class="nx">$obj</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="nx">_valueAux</span> <span class="p">);</span>

    <span class="c1">// Si hay más líneas de las esperadas
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">$obj</span><span class="p">[</span> <span class="s2">&#34;0&#34;</span> <span class="p">].</span><span class="nx">scrollHeight</span> <span class="o">&gt;</span> <span class="nx">_maxHeight</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">_lenValueAux</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1">// Reducimos el length del string hasta que queden las líneas deseadas
</span><span class="c1"></span>        <span class="k">while</span> <span class="p">(</span> <span class="nx">$obj</span><span class="p">[</span> <span class="s2">&#34;0&#34;</span> <span class="p">].</span><span class="nx">scrollHeight</span> <span class="o">&gt;</span> <span class="nx">_maxHeight</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">_valueAux</span> <span class="o">=</span> <span class="nx">_valueAux</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span> <span class="nx">_lenValueAux</span> <span class="o">-</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;…&#34;</span><span class="p">;</span>
            <span class="nx">$obj</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="nx">_valueAux</span> <span class="p">);</span>
            <span class="nx">_lenValueAux</span> <span class="o">=</span> <span class="nx">_valueAux</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>

<p>También hay <a href="http://dotdotdot.frebsite.nl/">plugins en jQuery,</a> para un uso más avanzado y complejo no está de más echarle un ojo. Para más información, o una implementación más optimizada, <a href="http://stackoverflow.com/questions/536814/insert-ellipsis-into-html-tag-if-content-too-wide">hay un hilo en Stackoverflow donde hablan del tema.</a></p>

    </div>
    <div class="my-16 border-b border-gray-400"></div>
    <div class="mb-6 text-center max-w-3xl mx-auto">
        
        <a class="outline-none bg-transparent text-green-700 font-semibold hover:text-white hover:bg-green-500 focus:text-white focus:bg-green-500 py-2 px-4 border border-green-500 hover:border-transparent rounded block mb-4" href="https://javifm.com/beta/blog/compilando-ficheros-sass-con-grunt/">
            &laquo; Compilando ficheros Sass con grunt
        </a>
        
        
        <a class="outline-none bg-transparent text-green-700 font-semibold hover:text-white hover:bg-green-500 focus:text-white focus:bg-green-500 py-2 px-4 border border-green-500 hover:border-transparent rounded block mb-4" href="https://javifm.com/beta/blog/jshint-y-formateo-de-c%C3%B3digo-al-hacer-commit-con-git-git-hooks/">
            JSHint y formateo de código al hacer commit con git (Git hooks) &raquo;
        </a>
        
    </div>

</div>


            </main>
            <footer class="bg-gray-900 text-blue-100 p-4">
    <div class="container">
        <div class="text-center">
            &copy; 2019 Sitio construido con Hugo alojado en Github.
        </div>
    </div>
</footer>

        </div>
    </div>
    
<script src="https://javifm.com/beta/js/focus-visible.min.js"></script>
<script>
    (function() {
        const $bodyElement = document.getElementsByTagName('body')[0];
        const $svgOpen = document.getElementById('open-menu');
        const $svgClose = document.getElementById('close-menu');
        const $siteCanvas = document.getElementById('site-canvas');
        const $siteMenu = document.getElementById('site-menu');
        const $buttonNav = document.getElementById('sidebar-open');
        const transitionEnd = transitionEndEventName();
        const CSS_CLASS_NAV = 'show-nav';
        let stateNav = 'closed';

        const closeMenuOnResize = debounce(function() {
            if ($bodyElement.classList.contains(CSS_CLASS_NAV) && window.screen.width > 639) {
                toggleNav();
            }
        }, 0);

        
        $buttonNav.addEventListener('click', toggleNav);
        window.addEventListener('resize', closeMenuOnResize);

        $siteCanvas.addEventListener(
            transitionEnd,
            function() {
                if (stateNav === 'opening') {
                    $svgOpen.classList.add('hidden');
                    $svgClose.classList.remove('hidden');
                    $buttonNav.setAttribute('aria-label', 'Cerrar menú');
                    stateNav = 'open';
                } else {
                    $svgOpen.classList.remove('hidden');
                    $svgClose.classList.add('hidden');
                    $siteMenu.classList.add('hidden');
                    $buttonNav.setAttribute('aria-label', 'Abrir menú');
                    stateNav = 'closed';
                }
            },
            false
        );
        
        

        function toggleNav() {
            if ($bodyElement.classList.contains(CSS_CLASS_NAV)) {
                $bodyElement.classList.remove(CSS_CLASS_NAV);
                stateNav = 'closing';
            } else {
                $bodyElement.classList.add(CSS_CLASS_NAV);
                stateNav = 'opening';
                $siteMenu.classList.remove('hidden');
            }
        }

        function debounce(func, wait, immediate) {
            let timeout;
            return function() {
                let context = this;
                let args = arguments;
                const later = function() {
                    timeout = null;
                    if (!immediate) {
                        func.apply(context, args);
                    }
                };
                let callNow = immediate && !timeout;
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
                if (callNow) {
                    func.apply(context, args);
                }
            };
        }

        function transitionEndEventName() {
            let i;
            const el = document.createElement('div');
            const transitions = {
                'transition': 'transitionend',
                'OTransition': 'otransitionend',  
                'MozTransition': 'transitionend',
                'WebkitTransition': 'webkitTransitionEnd'
            };

            for (i in transitions) {
                if (transitions.hasOwnProperty(i) && el.style[i] !== undefined) {
                    return transitions[i];
                }
            }
        }

    })();

</script>

    
</body>

</html>
